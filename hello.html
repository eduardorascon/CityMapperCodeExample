<html>
    <head>
        <style>
            #map {
                height: 100%;
            }
        </style>
        <title>{{ title }}</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                initMap();
                initMarkers();
            });

            var map;
            function initMap(){
                map = new google.maps.Map(document.getElementById('map'), {
                    center: { lat:19.4057, lng:-99.1488 },
                    zoom: 13
                });
            }

            var station_markers = [];
            function initMarkers () {
                $.ajax({
                    type:"POST",
                    url:"/ecobici",
                    dataType: "json"
                })
                .done(function(data) {
                    var lat, lon;
                    $.each(data["stations"], function(key, data) {
                        lat = (data["location"])["lat"];
                        lon = (data["location"])["lon"];
                        var marker = new google.maps.Marker({
                            position: new google.maps.LatLng(lat, lon),
                            animation: google.maps.Animation.DROP,
                            map: map
                        });
                        station_markers.push(marker);
                    });
                });
            }
        </script>
    </head>
<body>
    <div id="map"></div>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDO-JpX5xstJy9SzL630GoK3HLUUudYtNI" async defer>
    </script>
</body>
</html>